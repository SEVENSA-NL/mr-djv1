# A/B Testing Setup Guide - Mister DJ Website

## üìä MS-04: A/B Testing Implementation Status

### ‚úÖ Completed
1. **Feature Flag Hook** (`/frontend/lib/hooks/useFeatureFlag.ts`)
   - `useFeatureFlag<T>()` - Generic hook for any feature flag
   - `useMultivariateTest()` - Hook for multivariate testing
   - `trackConversion()` - Conversion tracking function

2. **A/B Test Configuration** (`/frontend/lib/ab-tests/config.ts`)
   - 6 test variants defined
   - Conversion events configured
   - Variant constants exported

3. **Video Testimonials Integration** (MS-03)
   - ‚úÖ VideoTestimonial component created
   - ‚úÖ Integrated on bruiloft-dj, bedrijfsfeest-dj, feest-dj pages
   - ‚úÖ PostHog tracking for views, plays, completions
   - ‚úÖ 7 testimonials configured (3 bruiloft, 1 bedrijfsfeest, 3 feest)

4. **Local SEO Pages**
   - ‚úÖ 100 cities configured in `/content/regions.json`
   - ‚úÖ Will be auto-generated by Next.js at build time

---

## üéØ 6 A/B Tests to Configure in PostHog

### Test 1: Hero CTA Button Text
**Flag Key**: `hero_cta_variant`
**Type**: Multivariate string
**Variants**:
- `control`: "Bekijk onze pakketten"
- `variant_a`: "Plan een gratis gesprek"
- `variant_b`: "Vraag direct offerte aan"

**Hypothesis**: More action-oriented CTAs will increase click-through rate.

**Success Metric**: Click-through rate on hero CTA button

---

### Test 2: Package Badge Label
**Flag Key**: `package_badge_variant`
**Type**: Multivariate string
**Variants**:
- `control`: "Meest gekozen"
- `variant_a`: "Best value"
- `variant_b`: "‚≠ê Favoriet"

**Hypothesis**: Different badge labels will influence package selection.

**Success Metric**: Clicks on Zilver package (most common choice)

---

### Test 3: Testimonial Format
**Flag Key**: `testimonial_format`
**Type**: Multivariate string
**Variants**:
- `control`: "text" (static text testimonials)
- `variant_a`: "video" (video testimonials - already implemented)
- `variant_b`: "mixed" (combination of both)

**Hypothesis**: Video testimonials will increase trust and conversion rate.

**Success Metric**: Form submissions after viewing testimonials

---

### Test 4: Booking CTA Text
**Flag Key**: `booking_cta_variant`
**Type**: Multivariate string
**Variants**:
- `control`: "Check beschikbaarheid"
- `variant_a`: "Reserveer je datum"
- `variant_b`: "Vraag beschikbaarheid op"

**Hypothesis**: More direct "Reserveer" language will increase bookings.

**Success Metric**: Availability check submissions

---

### Test 5: Price Display Format
**Flag Key**: `price_display_variant`
**Type**: Multivariate string
**Variants**:
- `control`: "vanaf ‚Ç¨495" (from price)
- `variant_a`: "‚Ç¨495 - ‚Ç¨1,295" (price range)
- `variant_b`: "Maatwerk prijzen" (custom pricing message)

**Hypothesis**: Transparent pricing range will reduce friction.

**Success Metric**: Quote requests and package selections

---

### Test 6: WhatsApp Button Prominence
**Flag Key**: `whatsapp_prominence`
**Type**: Multivariate string
**Variants**:
- `control`: "normal" (standard button)
- `variant_a`: "prominent" (larger, more visible styling)
- `variant_b`: "floating" (floating action button, bottom-right)

**Hypothesis**: More prominent WhatsApp CTA will increase direct inquiries.

**Success Metric**: WhatsApp button clicks

---

## üé® How to Set Up Feature Flags in PostHog

### Step 1: Log into PostHog Dashboard
1. Go to your PostHog instance (https://app.posthog.com or self-hosted)
2. Navigate to **Feature Flags** in the left sidebar

### Step 2: Create Each Feature Flag

For each of the 6 tests above, create a new feature flag:

1. Click **"New Feature Flag"**
2. Enter the **Flag Key** (e.g., `hero_cta_variant`)
3. Set **Type** to **"String"** (for multivariate tests)
4. Enable **"Multivariate"** toggle
5. Add the variants with their percentages:
   - Variant A (control): 33%
   - Variant B (variant_a): 33%
   - Variant C (variant_b): 34%

6. Set rollout to **100%** of users
7. Click **"Save"**

### Step 3: Set Up Conversion Goals

In PostHog:
1. Go to **Actions** section
2. Create the following actions:
   - `contact_form_submitted`
   - `whatsapp_clicked`
   - `quote_requested`
   - `package_selected`
   - `availability_checked`
   - `phone_clicked`

### Step 4: Create Experiments

1. Go to **Experiments** in PostHog
2. For each feature flag, create an experiment:
   - Select the feature flag
   - Set the goal metric (conversion event)
   - Set minimum sample size: 300 conversions per variant
   - Start the experiment

---

## üìà Tracking & Monitoring

### Events Already Being Tracked

The following events are already instrumented:

**Video Testimonials** (`VideoTestimonial.tsx`):
- `video_testimonial_viewed`
- `video_testimonial_played`
- `video_testimonial_completed`

**Availability Checker** (`AvailabilityChecker.tsx`):
- `availability_check_started`
- `availability_check_completed`

**Price Calculator** (`PriceCalculator.tsx`):
- `price_calculator_addon_toggle`
- `price_calculator_package_change`
- `price_calculator_get_quote`

### Additional Tracking Needed

You may want to add conversion tracking to:
1. Contact form submission
2. WhatsApp button clicks
3. Phone number clicks
4. Quote request buttons

Example implementation:
```typescript
import { trackConversion } from '@/lib/hooks/useFeatureFlag';

function handleContactSubmit() {
  // ... form submission logic
  trackConversion('contact_form_submitted', {
    form_type: 'contact',
    source_page: window.location.pathname,
  });
}
```

---

## üß™ Running the Tests

### Test Duration
- Minimum: Until 300 conversions per variant are reached
- Maximum: 4-6 weeks (typical A/B test duration)

### Statistical Significance
- Use PostHog's built-in statistical significance calculator
- Aim for **95% confidence level**
- **p-value < 0.05** to declare a winner

### Making Decisions
1. Wait for minimum sample size (300 conversions per variant)
2. Check statistical significance in PostHog
3. Analyze secondary metrics (bounce rate, time on page)
4. Roll out winning variant to 100%

---

## üéØ Expected Impact

**Target**: +15-25% aggregate conversion improvement (as specified in MS-04)

**Key Metrics to Monitor**:
- Overall conversion rate
- Quote requests
- Availability checks
- WhatsApp inquiries
- Form submissions

---

## üìÅ Files Created

1. `/frontend/lib/hooks/useFeatureFlag.ts` - Feature flag hooks
2. `/frontend/lib/ab-tests/config.ts` - A/B test configuration
3. `/frontend/components/video/VideoTestimonial.tsx` - Video testimonials component
4. `/frontend/data/testimonials.ts` - Testimonial data (7 testimonials)
5. `/content/regions.json` - 100 cities for local SEO

---

## üöÄ Next Steps

1. **Configure Feature Flags in PostHog**
   - Create the 6 feature flags listed above
   - Set up multivariate testing with 33/33/34% splits
   - Enable for 100% of users

2. **Implement A/B Test Variants in Components**
   - Update hero section to use `hero_cta_variant`
   - Update pricing tables to use `package_badge_variant` and `price_display_variant`
   - Update booking form to use `booking_cta_variant`
   - Update WhatsApp button to use `whatsapp_prominence`
   - Update testimonial sections to use `testimonial_format`

3. **Add Conversion Tracking**
   - Contact form submissions
   - Quote request buttons
   - Phone number clicks

4. **Deploy and Monitor**
   - Build and deploy the frontend
   - Monitor PostHog dashboard for data
   - Review results after 300+ conversions per variant

5. **Upload Videos to CDN** (pending)
   - Current: Videos stored locally in `/assets/videos/`
   - Target: Upload to Cloudflare R2 / AWS S3 / Vercel Blob
   - Update URLs in `testimonials.ts`

---

## üìä Current Progress: 11/12 Complete (92%)

‚úÖ MS-01: Smart booking & dynamic pricing
‚úÖ MS-02: Comprehensive lead nurture system
‚úÖ MS-03: Video testimonials integration
‚úÖ Local SEO: 100 city pages configured
‚è≥ MS-04: A/B testing setup (infrastructure complete, needs PostHog config)
‚è≥ CDN upload for videos (pending)

**Target**: 12/12 complete (100%)
